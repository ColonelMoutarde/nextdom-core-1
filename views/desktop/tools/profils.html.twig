<div class="box" id="div_Profils">
    <!-- Header bar -->
    <div class="box-header with-border">
        <h3 class="box-title"><i class="fas fa-pencil-square">&nbsp;&nbsp;</i>{{ 'Profil utilisateur'}}</h3>
        <div class="box-tools pull-right">
            <a class="pull-right btn-box-tool" href="index.php?v=d&p=administration"><i class="fas fa-times"></i></a>
        </div>
    </div>

    <!-- Page content -->
    <div class="box-body">
        <div class="nav-tabs-custom config">

            <!-- Tabs title -->
            <ul class="nav nav-tabs pull-right" role="tablist">
                <li role="presentation"><a href="#themetab" aria-controls="home" role="tab" data-toggle="tab"><i class="fas fa-tint">&nbsp;&nbsp;</i>{{ 'Thèmes' }}</a></li>
                <li role="presentation"><a href="#interfacetab" aria-controls="profile" role="tab" data-toggle="tab"><i class="fas fa-laptop">&nbsp;&nbsp;</i>{{ 'Interface' }}</a></li>
                <li role="presentation"><a href="#notificationtab" aria-controls="profile" role="tab" data-toggle="tab"><i class="fas fa-comments">&nbsp;&nbsp;</i>{{ 'Notifications' }}</a></li>
                <li role="presentation"><a href="#securitytab" aria-controls="profile" role="tab" data-toggle="tab"><i class="fas fa-user-secret">&nbsp;&nbsp;</i>{{ 'Sécurité' }}</a></li>
                <li role="presentation" class="active"><a href="#profil" aria-controls="home" role="tab" data-toggle="tab"><i class="fas fa-user">&nbsp;&nbsp;</i>{{ 'Profil' }}</a></li>
            </ul>

            <!-- Tabs content -->
            <div class="global-tab-content tab-content">

                <!-- Profil tab -->
                <div role="tabpanel" class="tab-pane active" id="profil">
                    <legend class="legend-title">{{ 'Choix de la photo de profil' }}</legend>
                    <div class="col-sm-6">
                        <form class="form-horizontal">
                            <fieldset>
                                <div class="form-group">
                                    <input class="userAttr form-control" data-l1key="options" data-l2key="avatar" style="display:none"/>
                                    <div>
                                        <input class="userAttr form-control" id="user_avatar" type="file" name="images" data-url="core/ajax/profils.ajax.php?action=imageUpload"/>
                                    </div>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                    <div class="col-sm-6">
                        <img id="monAvatar" src="{{ profilsUser.getOptions('avatar') }}" style="width:auto; height:200px"></a>
                    </div>
                </div>

                <!-- Themes tab -->
                <div role="tabpanel" class="tab-pane" id="themetab">
                    <legend class="legend-title">{{ 'Personnalisation' }}</legend>
                    <div class="col-sm-12">
                        <form class="form-horizontal">
                            <fieldset>
                                <div class="form-group">
                                    <label class="col-sm-6 control-label">{{ 'Couleur sur mobile' }}</label>
                                    <div class="col-sm-6">
                                        <select class="userAttr form-control" data-l1key="options" data-l2key="mobile_theme_color">
                                            {% for theme in profilsMobileThemes %}
                                                <option value="{{ theme }}">{{ theme|capitalize|replace({'_': ' '}) }}</option>
                                            {% endfor %}
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-6 control-label">{{ 'Graphique Desktop' }}</label>
                                    <div class="col-sm-6">
                                        <select class="userAttr form-control" data-l1key="options" data-l2key="desktop_highcharts_theme">
                                            <option value="">Défaut</option>
                                            <option value="dark-blue">Dark-blue</option>
                                            <option value="dark-green">Dark-green</option>
                                            <option value="dark-unica">Dark-unica</option>
                                            <option value="gray">Gray</option>
                                            <option value="grid-light">Grid-light</option>
                                            <option value="grid">Grid</option>
                                            <option value="sand-signika">Sand-signika</option>
                                            <option value="skies">Skies</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-6 control-label">{{ 'Graphique mobile' }}</label>
                                    <div class="col-sm-6">
                                        <select class="userAttr form-control" data-l1key="options" data-l2key="mobile_highcharts_theme">
                                            <option value="">Défaut</option>
                                            <option value="dark-blue">Dark-blue</option>
                                            <option value="dark-green">Dark-green</option>
                                            <option value="dark-unica">Dark-unica</option>
                                            <option value="gray">Gray</option>
                                            <option value="grid-light">Grid-light</option>
                                            <option value="grid">Grid</option>
                                            <option value="sand-signika">Sand-signika</option>
                                            <option value="skies">Skies</option>
                                        </select>
                                    </div>
                                </div>
                                {% for displayTypeCode, displayTypeData in profilsDisplayTypes %}
                                    <div class="form-group">
                                        <label class="col-sm-6 control-label">{{ 'Opacité par des widgets' }} {{ displayTypeData['name'] }}</label>
                                        <div class="col-sm-6">
                                            <input type="number" min="0" max="1" class="userAttr form-control" data-l1key="options" data-l2key="widget::background-opacity::{{ displayTypeCode }}"/>
                                        </div>
                                    </div>
                                {% endfor %}
                            </fieldset>
                        </form>
                    </div>
                    <div class="col-sm-12">
                        <div class="img-responsive" id="div_imgThemeDesktop" style="height: 450px;"></div>
                    </div>
                </div>

                <!-- Interface tab -->
                <div role="tabpanel" class="tab-pane" id="interfacetab">
                    <legend class="legend-title">{{ 'Options d\'interfaces' }}</legend>
                    <form class="form-horizontal">
                        <fieldset>
                            <legend><i class="fas fa-home"></i> {{ 'Général' }}</legend>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Afficher les menus' }}</label>
                                <div class="col-sm-1">
                                    <input type="checkbox" class="userAttr" data-l1key="options" data-l2key="doNotAutoHideMenu"/>
                                </div>
                            </div>
                        </fieldset>
                    </form>

                    <form class="form-horizontal">
                        <fieldset>
                            <legend class="legend-title">{{ 'Page par défaut' }}</legend>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Desktop' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="homePage">
                                        {% for homePageCode, homePageValue in profilsHomePage %}
                                            <option value="{{ homePageCode }}">{{ homePageValue }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <label class="col-sm-1 control-label">{{ 'Mobile' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="homePageMobile">
                                        <option value="home">{{ 'Accueil' }}</option>
                                        {% for homePageCode, homePageValue in profilsHomePage %}
                                            <option value="{{ homePageCode }}">{{ homePageValue }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <legend class="legend-title">{{ 'Objet par défaut sur le dashboard' }}</legend>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Desktop' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="defaultDashboardObject">
                                        {% for jeeObject in profilsJeeObjects %}
                                            <option value="{{ jeeObject.getId() }}">{{ jeeObject.getName() }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <label class="col-sm-1 control-label">{{ 'Mobile' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="defaultMobileObject">
                                        <option value='all'>{{ 'Tout' }}</option>
                                        {% for jeeObject in profilsJeeObjects %}
                                            <option value="{{ jeeObject.getId() }}">{{ jeeObject.getName() }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <legend class="legend-title">{{ 'Vue par défaut' }}</legend>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Desktop' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="defaultDesktopView">
                                        {% for view in profilsViews %}
                                            <option value="{{ view.getId() }}">{{ view.getName() }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <label class="col-sm-1 control-label">{{ 'Mobile' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="defaultMobileView">
                                        {% for view in profilsViews %}
                                            <option value="{{ view.getId() }}">{{ view.getName() }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>

                            <legend class="legend-title">{{ 'Design par défaut' }}</legend>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Desktop' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="defaultDashboardPlan">
                                        {% for plan in profilsPlans %}
                                            <option value="{{ plan.getId() }}">{{ plan.getName() }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <label class="col-sm-1 control-label">{{ 'Mobile' }}</label>
                                <div class="col-sm-2">
                                    <select class="userAttr form-control" data-l1key="options" data-l2key="defaultMobilePlan">
                                        {% for plan in profilsPlans %}
                                            <option value="{{ plan.getId() }}">{{ plan.getName() }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Plein écran' }}</label>
                                <div class="col-sm-1">
                                    <input type="checkbox" class="userAttr" data-l1key="options" data-l2key="defaultPlanFullScreen"/>
                                </div>
                            </div>

                            <legend class="legend-title">{{ 'Dashboard' }}</legend>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Déplier le panneau des scénarios' }}</label>
                                <div class="col-sm-1">
                                    <input type="checkbox" class="userAttr" data-l1key="options" data-l2key="displayScenarioByDefault"/>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Déplier le panneau des objets' }}</label>
                                <div class="col-sm-1">
                                    <input type="checkbox" class="userAttr" data-l1key="options" data-l2key="displayObjetByDefault"/>
                                </div>
                            </div>

                            <legend class="legend-title">{{ 'Vue' }}</legend>
                            <div class="form-group">
                                <label class="col-sm-3 control-label">{{ 'Déplier le panneau des vues' }}</label>
                                <div class="col-sm-1">
                                    <input type="checkbox" class="userAttr" data-l1key="options" data-l2key="displayViewByDefault"/>
                                </div>
                            </div>
                        </fieldset>
                    </form>
                </div>

                <!-- Security tab -->
                <div role="tabpanel" class="tab-pane" id="securitytab">
                    <form class="form-horizontal">
                        <fieldset>
                            {% if profilsAllowRemoteUsers != 1 %}
                                <div class="form-group">
                                    <label class="col-lg-2 col-md-3 col-sm-4 col-xs-6 control-label">{{ 'Authentification en 2 étapes' }}</label>
                                    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                        <a class="btn btn-default" id="bt_configureTwoFactorAuthentification"><i class="fas fa-cogs"></i> {{ 'Configurer' }}</a>
                                    </div>
                                    {% if profilsUser.getOptions('twoFactorAuthentification', 0) == 1 %}
                                        <label class="col-lg-1 col-md-2 col-sm-2 col-xs-2 control-label">{{ 'Actif' }}</label>
                                        <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                            <input type="checkbox" class="userAttr" data-l1key="options" data-l2key="twoFactorAuthentification"/>
                                        </div>
                                    {% endif %}
                                </div>

                                <div class="form-group">
                                    <label class="col-lg-2 col-md-3 col-sm-4 col-xs-6 control-label">{{ 'Mot de passe' }}</label>
                                    <div class="col-lg-3 col-md-4 col-sm-5 col-xs-6">
                                        <input type="password" class="userAttr form-control" data-l1key="password"/>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-lg-2 col-md-3 col-sm-4 col-xs-6 control-label">{{ 'Retapez le mot de passe' }}</label>
                                    <div class="col-lg-3 col-md-4 col-sm-5 col-xs-6">
                                        <input type="password" class="form-control" id="in_passwordCheck"/>
                                    </div>
                                </div>
                            {% endif %}
                            <div class="form-group">
                                <label class="col-lg-2 col-md-3 col-sm-4 col-xs-6 control-label">{{ 'Hash de l\'utilisateur' }}</label>
                                <div class="col-lg-3 col-md-4 col-sm-5 col-xs-6">
                                    <span class="userAttr" data-l1key="hash"></span>
                                </div>
                                <div class="col-lg-2 col-md-3 col-sm-3">
                                    <a class="btn btn-default form-control" id="bt_genUserKeyAPI"><i class="fas fa-refresh"></i> {{ 'Regénérer' }}</a>
                                </div>
                            </div>
                        </fieldset>
                    </form>

                    <form class="form-horizontal">
                        <fieldset>
                            <legend>{{ 'Sessions actives' }}</legend>
                            <table class="table table-condensed table-bordered">
                                <thead>
                                <tr>
                                    <th>{{ 'ID' }}</th>
                                    <th>{{ 'IP' }}</th>
                                    <th>{{ 'Date' }}</th>
                                    <th>{{ 'Actions' }}</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for id, session in profilsSessionsList %}
                                    {% if session['user_id'] == profilsUser.getId() %}
                                        <tr data-id="{{ id }}">
                                            <td>{{ id }}</td>
                                            <td>{{ session['ip'] }}</td>
                                            <td>{{ session['datetime'] }}</td>
                                            <td><a class="btn btn-xs btn-warning bt_deleteSession"><i class="fas fa-sign-out-alt"></i> {{ 'Déconnecter' }}</a></td>
                                        </tr>
                                    {% endif %}
                                {% endfor %}
                                </tbody>
                            </table>
                        </fieldset>
                    </form>

                    <form class="form-horizontal">
                        <fieldset>
                            <legend>{{ 'Périphériques enregistrés' }} <a class="btn btn-xs btn-warning pull-right" id="bt_removeAllRegisterDevice"><i class="fas fa-trash"></i> {{ 'Supprimer tout' }}</a></legend>
                            <table class="table table-bordered table-condensed">
                                <thead>
                                <tr>
                                    <th>{{ 'Identification' }}</th>
                                    <th>{{ 'IP' }}</th>
                                    <th>{{ 'Date dernière utilisation' }}</th>
                                    <th>{{ 'Action' }}</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for sessionCode, sessionData in profilsUser.getOptions('registerDevice') %}
                                    <tr data-key="{{ sessionCode }}">
                                        <td>{{ sessionCode|slice(0, 10) }}</td>
                                        <td>{{ sessionData['ip'] }}</td>
                                        <td>{{ sessionData['datetime'] }}</td>
                                        <td>
                                            <a class="btn btn-warning btn-xs bt_removeRegisterDevice"><i class="fas fa-trash"></i> {{ 'Supprimer' }}</a>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </fieldset>
                    </form>
                </div>

                <!-- Notification tab -->
                <div role="tabpanel" class="tab-pane" id="notificationtab">
                    <form class="form-horizontal">
                        <fieldset>
                            <div class="form-group">
                                <label class="col-lg-2 col-md-3 col-sm-4 col-xs-6 control-label">{{ 'Commande de notification utilisateur' }}</label>
                                <div class="col-lg-3 col-md-4 col-sm-5 col-xs-6">
                                    <div class="input-group">
                                        <input type="text" class="userAttr form-control" data-l1key="options" data-l2key="notification::cmd"/>
                                        <span class="input-group-btn">
                                                <a class="btn btn-default cursor bt_selectWarnMeCmd" data-toggle="tooltip" title="" data-original-title="Rechercher une commande"><i class="fas fa-list-alt"></i></a>
                                            </span>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer bar -->
    <div class="box-footer clearfix">
        <a class="btn btn-success pull-right" id="bt_saveProfils"><i class="fas fa-save">&nbsp;&nbsp;</i>{{ 'Sauvegarder' }}</a>
        <a class="btn btn-danger pull-right" href="index.php?v=d&p=administration"><i class="fas fa-chevron-left">&nbsp;&nbsp;</i>{{ 'Retour' }}</a>
    </div>
</div>
